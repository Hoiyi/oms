package com.hu.operation.duty.controller;import com.hu.operation.duty.service.MonthDutyService;import com.hu.sysManagement.common.utils.Result;import com.hu.sysManagement.system.domain.User;import com.hu.sysManagement.system.service.UserService;import java.io.UnsupportedEncodingException;import java.net.URLDecoder;import java.util.ArrayList;import java.util.HashMap;import java.util.List;import javax.annotation.Resource;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestBody;import org.springframework.web.bind.annotation.ResponseBody;@Controllerpublic class MonthDutyController {    private final Logger logger = LoggerFactory.getLogger(getClass());    @Resource    MonthDutyService monthDutyService;    @Resource    UserService userService;    String prefix = "operation/duty/MonthDuty";    @GetMapping({"/duty/monthDuty"})    public String toMonthDuty(Model model) {        List<String> list = monthDutyService.list(3);        String dutyUser = monthDutyService.getDutyEmp(3).getName();        String nextDutyUser = monthDutyService.getNextDutyEmp(3).getName();        model.addAttribute("dutyEmp", dutyUser);        model.addAttribute("nextDutyEmp", nextDutyUser);        model.addAttribute("list", list);        return prefix + "/MonthDuty";    }    @GetMapping({"/duty/MonthDuty/addDutyEmp"})    public String addDutyEmp(Model model) {        HashMap<String, Object> map = new HashMap<>();        List<User> userList = userService.userList(map);        List<String> dutyList = monthDutyService.list(3);        List<Object> userList1 = new ArrayList<>();        for (User u : userList) {            userList1.add(u.getName());        }        userList1.removeAll(dutyList);        model.addAttribute("userList", userList1);        model.addAttribute("dutyList", dutyList);        return prefix + "/addDutyEmp";    }    @GetMapping({"/duty/MonthDuty/setDutyEmp"})    public String setDutyEmp(Model model) {        List<String> dutyList = monthDutyService.list(3);        model.addAttribute("dutyList", dutyList);        return prefix + "/setDutyEmp";    }    @PostMapping({"/duty/MonthDuty/saveEmpList"})    @ResponseBody    public Result saveEmpList(@RequestBody String str) throws UnsupportedEncodingException {        String str1 = URLDecoder.decode(str, "utf-8");        String str2 = str1.substring(0, str1.length() - 2);        System.out.println(str2);        monthDutyService.saveDutyEmp(str2, 3);        return Result.ok();    }    @PostMapping({"/duty/MonthDuty/setCurrDuty"})    @ResponseBody    public Result setCurrDuty(@RequestBody String str) throws UnsupportedEncodingException {        String str1 = URLDecoder.decode(str, "utf-8");        String str2 = str1.substring(0, str1.length() - 1);        String[] strs = str2.split(",");        int currDuty = Integer.parseInt(strs[0]);        int dutyType = Integer.parseInt(strs[1]);        System.out.println(currDuty);        System.out.println(dutyType);        monthDutyService.setCurrDuty(currDuty, dutyType);        return Result.ok();    }}