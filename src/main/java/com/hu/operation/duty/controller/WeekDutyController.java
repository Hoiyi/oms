package com.hu.operation.duty.controller;import com.hu.operation.duty.service.MonthDutyService;import com.hu.sysManagement.common.utils.Result;import com.hu.sysManagement.system.domain.User;import com.hu.sysManagement.system.service.UserService;import java.io.UnsupportedEncodingException;import java.net.URLDecoder;import java.util.ArrayList;import java.util.HashMap;import java.util.List;import javax.annotation.Resource;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestBody;import org.springframework.web.bind.annotation.ResponseBody;@Controllerpublic class WeekDutyController {    @Resource    MonthDutyService monthDutyService;    @Resource    UserService userService;    String prefix = "operation/duty/WeekDuty";    @GetMapping({"/duty/weekDuty"})    public String toWeekDuty(Model model) {        List<String> xaList = monthDutyService.list(1);        String xaDutyUser = monthDutyService.getDutyEmp(1).getName();        String xaNextDutyUser = monthDutyService.getNextDutyEmp(1).getName();        List<String> djList = monthDutyService.list(2);        String djDutyUser = monthDutyService.getDutyEmp(2).getName();        String djNextDutyUser = monthDutyService.getNextDutyEmp(2).getName();        model.addAttribute("xaDutyUser", xaDutyUser);        model.addAttribute("xaNextDutyUser", xaNextDutyUser);        model.addAttribute("xaList", xaList);        model.addAttribute("djList", djList);        model.addAttribute("djDutyUser", djDutyUser);        model.addAttribute("djNextDutyUser", djNextDutyUser);        return prefix + "/WeekDuty";    }    @GetMapping({"/duty/WeekDuty/xaAddDutyEmp"})    public String xaAddDutyEmp(Model model) {        HashMap<String, Object> map = new HashMap<>();        List<User> userList = userService.userList(map);        List<String> dutyList = monthDutyService.list(1);        List<String> userList1 = new ArrayList<>();        for (User u : userList) {            userList1.add(u.getName());        }        userList1.removeAll(dutyList);        model.addAttribute("userList", userList1);        model.addAttribute("dutyList", dutyList);        return prefix + "/xaAddDutyEmp";    }    @GetMapping({"/duty/WeekDuty/djAddDutyEmp"})    public String djAddDutyEmp(Model model) {        HashMap<String, Object> map = new HashMap<>();        List<User> userList = userService.userList(map);        List<String> dutyList = monthDutyService.list(2);        List<String> userList1 = new ArrayList<>();        for (User u : userList) {            userList1.add(u.getName());        }        userList1.removeAll(dutyList);        model.addAttribute("userList", userList1);        model.addAttribute("dutyList", dutyList);        return prefix + "/djAddDutyEmp";    }    @PostMapping({"/duty/WeekDuty/saveXaEmpList"})    @ResponseBody    public Result saveXaEmpList(@RequestBody String str) throws UnsupportedEncodingException {        String str1 = URLDecoder.decode(str, "utf-8");        String str2 = str1.substring(0, str1.length() - 2);        System.out.println(str2);        monthDutyService.saveDutyEmp(str2, 1);        return Result.ok();    }    @PostMapping({"/duty/WeekDuty/saveDjEmpList"})    @ResponseBody    public Result saveDjEmpList(@RequestBody String str) throws UnsupportedEncodingException {        String str1 = URLDecoder.decode(str, "utf-8");        String str2 = str1.substring(0, str1.length() - 2);        System.out.println(str2);        monthDutyService.saveDutyEmp(str2, 2);        return Result.ok();    }    @GetMapping({"/duty/WeekDuty/xaSetCurrDuty"})    public String setXaCurrDuty(Model model) {        List<String> dutyList = monthDutyService.list(1);        model.addAttribute("dutyList", dutyList);        return prefix + "/setXaDutyEmp";    }    @GetMapping({"/duty/WeekDuty/djSetCurrDuty"})    public String setDjCurrDuty(Model model) {        List<String> dutyList = monthDutyService.list(2);        model.addAttribute("dutyList", dutyList);        return prefix + "/setDjDutyEmp";    }}